<!doctype html>
<html>
<head>
<meta charset="utf-8">
<title>  Christmas Movies  </title>
<link rel="stylesheet" href="movies.css">
<link href="https://fonts.googleapis.com/css?family=Mountains+of+Christmas" rel="stylesheet">
<!-- <script src ="snow.js"></script> -->

<script src = "jquery/jquery-3.3.1.min.js"></script>
<script>

$(document).ready(function(){
	$("#getUserSearch").click(function(event){
		event.preventDefault();
		$.ajax({
						type: "POST",
						enctype: 'multipart/form-data',
						url: "../php/retrievePostmusic.php",
						data: "",
						processData: false,//prevents from converting into a query string
						contentType: false,
						cache: false,
						timeout: 600000,
						success: function (response) {
						//console.log(response);

						let parsedJSON = JSON.parse(response);
						 console.log(parsedJSON);
					 },
					 error:function(){
					console.log("error occurred");
				}
			});
		});


$("#searchButton").click(function(event){
	let searchItem = $("#searchText").val();
	$("#imageElements").empty();
	console.log(searchItem);
	$.getJSON('movies.json',function(data) {
 //success
	;
	console.log(data);



	for(let i=0; i< data.Stairs.length; i++){
		console.log(data.Stairs[i].Day.toLowerCase()===searchItem.toLowerCase());
		if(data.Stairs[i].Day.toLowerCase().includes(searchItem.toLowerCase())){
			console.log("test");
			let imageTagContainer= document.createElement("div");
      let imageTag= document.createElement("img");
			 imageTag.src = "images/"+data.Stairs[i].Image;

			 imageTagContainer.appendChild(imageTag);
			 document.getElementById("imageElements").appendChild(imageTagContainer);


		}
	}
 })
 //store item into array ...
	 let dataSearch  = new FormData();
	 dataSearch.append('userSearch',  searchItem);

			 $.ajax({
							 type: "POST",
							 enctype: 'multipart/form-data',
							 url: "../php/insertPostmovies.php",
							 data: dataSearch,
							 processData: false,//prevents from converting into a query string
							 contentType: false,
							 cache: false,
							 timeout: 600000,
							 success: function (response) {
							 console.log(response);
							 user = response;
							 //activateLinks();
							},
							error:function(){
						 console.log("error occurred");
					 }
				 });
 })
 //fail
 .fail(function() {
	 console.log( "error" );
 });
}); //click
});//ready
</script>

</head>
<body>

<h1>Welcome to 12 Days of Databases door two. </h1>
<h1> Today's activite is watching some Christmas movies  </h1>
<h1> Type in a movie you want to watch to and see if the database agrees with you. </h1>
<h1> Happy watching </h1>
<div class = "buttonWrapper">
<button type="FINAL/index.html"class="button button1">HOME</button>
<button id = "getUserSearch" type="#" class="button button2">SEE OTHER USERS INPUT</button>
</div>
<h2> Click Search not the return key</h2>




<p>
<input type="text" id="searchText" value="search Item" />
<input type="button" value="Search!" id="searchButton" />
<br/>
<div id = "imageElements"></div>
</p>



<div id="images"></div>


</body>
</html>
